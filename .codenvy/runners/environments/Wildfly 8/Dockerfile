FROM marcusschiesser/jdk7_wildfly8
RUN sed -i '/<security-domains>/a <security-domain name="my-campaign" cache-type="default"><authentication><login-module code="Database" flag="required"><module-option name="dsJndiName" value="java:jboss/datasources/MyCampaignDS"/><module-option name="principalsQuery" value="select password from organizer where email=?"/><module-option name="rolesQuery" value="select \x27Organizer\x27,\x27Roles\x27 from organizer where email=?"/><module-option name="hashAlgorithm" value="SHA-256"/><module-option name="hashEncoding" value="hex" /><module-option name="hashCharset" value="UTF-8" /></login-module></authentication></security-domain>' /home/user/wildfly/standalone/configuration/standalone.xml
ADD $app$ /home/user/wildfly/standalone/deployments/ROOT.war